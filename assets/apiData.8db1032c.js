import{ah as r}from"./index.5011e529.js";function o(i,n){const a=new AbortController,t=Object.assign({},n);if(t.signal)throw new Error("signal must be not set");t.signal=a.signal;const e=fetch(i,n);return e.cancel=a.abort.bind(a),e}function s(i){const a=r(`q/${i}`,{state:()=>({query:i,loading:!1,data:void 0,error:void 0,canceller:void 0}),getters:{initialized:t=>!!(t.data||t.error||t.loading),finishedAt:t=>{if(t.data)return new Date(t.data.finishedAt)},single:t=>{var e;return(e=t.data)==null?void 0:e.data[0]}},actions:{reload(){if(this.loading)return;this.loading=!0,this.error=void 0;const t=o(`https://api.ossinsight.io/q/${i}`);this.canceller=t.cancel,t.then(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}).then(e=>{this.data=e}).catch(e=>{this.error=e}).finally(()=>{this.loading=!1,this.canceller=void 0})},cancel(){var t;(t=this.canceller)==null||t.call(this)}}})();return a.initialized||a.reload(),a}export{s as u};
